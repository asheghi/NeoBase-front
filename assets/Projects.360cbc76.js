import{A as j,t as p}from"./api.4a23552d.js";import{I as M}from"./plus.37fb27b0.js";import{o as a,c as l,a as s,_ as v,b as i,h as P,e as f,C as B,w as I,v as b,d,g as N,t as y,F as _,x as w,k as g}from"./index.3088f20f.js";import{M as F}from"./Modal.d547bb9a.js";import{N as V}from"./N-Button.318009ac.js";const m={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},$=s("path",{d:"M10 4H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-8l-2-2Z"},null,-1),D=[$];function A(e,t){return a(),l("svg",m,D)}m.width="24";m.height="24";m.viewBox="0 0 24 24";var K={render:A};const T={name:"NewProjectModal",components:{Modal:F,NButton:V},emits:["created"],data(){return{form:{name:""},loading:!1}},methods:{show(){this.$refs.modal.show()},async submit(){if(!this.loading){this.loading=!0;try{const{data:e,status:t}=await j.Projects.create({name:this.form.name});this.$refs.modal.hide(),this.form.name="",this.$emit("created",e),p("New project created")}catch(e){console.error(e),p("Failed to create project",{text:e.response.data.msg,icon:"error"})}finally{this.loading=!1}}}}},E={class:"new-project"},H={class:"form-group"},L=s("label",{for:"email"},"Project Name",-1);function S(e,t,k,x,o,n){const u=i("NButton"),h=i("Modal");return a(),P(h,{ref:"modal","close-on-click-outside":!o.loading,onClosed:t[2]||(t[2]=c=>o.form.name="")},{default:f(()=>[s("div",E,[s("div",{class:"form",onKeydown:t[1]||(t[1]=B((...c)=>n.submit&&n.submit(...c),["enter"]))},[s("div",H,[L,I(s("input",{id:"email","onUpdate:modelValue":t[0]||(t[0]=c=>o.form.name=c),name:"email",placeholder:"what's the name of your app?"},null,512),[[b,o.form.name]])]),d(u,{loading:o.loading,class:"primary w-full",onClick:n.submit},{default:f(()=>[N(y(o.loading?"Creating new":"Create")+" project ",1)]),_:1},8,["loading","onClick"])],32)])]),_:1},8,["close-on-click-outside"])}var U=v(T,[["render",S]]);const Z={name:"ManageProjects",components:{NewProjectModal:U,IconPlus:M,IconFolder:K},data(){return{projects:[],fetching:null}},mounted(){this.fetchData()},methods:{onNewProject(){this.$refs.newProjectModal.show()},onNewProjectCreated(){this.fetchData()},async fetchData(){this.fetching=!0;try{const{data:e}=await j.Projects.list();this.projects=e}catch(e){console.error(e)}finally{this.fetching=!1}}}},q={class:"ManageProjects"},z={class:"list"},G=s("span",null,"New Project",-1);function J(e,t,k,x,o,n){const u=i("IconFolder"),h=i("router-link"),c=i("IconPlus"),C=i("NewProjectModal");return a(),l("div",q,[s("div",z,[o.fetching?(a(),l(_,{key:0},w(3,r=>s("div",{key:r,class:"card skeloading"})),64)):g("",!0),o.fetching?g("",!0):(a(),l(_,{key:1},[(a(!0),l(_,null,w(o.projects,r=>(a(),P(h,{key:r._id,to:{name:"collections",params:{project:r.name}},class:"card"},{default:f(()=>[d(u,{class:"icon",viewBox:"0 0 24 24"}),N(" "+y(r.name),1)]),_:2},1032,["to"]))),128)),s("button",{class:"card",onClick:t[0]||(t[0]=(...r)=>n.onNewProject&&n.onNewProject(...r))},[d(c,{viewBox:"0 0 20 20",class:"icon"}),G])],64))]),d(C,{ref:"newProjectModal",onCreated:n.onNewProjectCreated},null,8,["onCreated"])])}var Y=v(Z,[["render",J]]);export{Y as default};
